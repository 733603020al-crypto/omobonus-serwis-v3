# Анализ проблемы: неотображающиеся цены в мобильной версии таблицы wynajem-drukarek

**Дата анализа:** 2025-01-26  
**Страница:** `/uslugi/wynajem-drukarek`  
**Раздел:** "Wynajem (Dzierżawa) Drukarek" — аренда принтеров

---

## 1. Расположение HTML-элементов с ценами

### Файл: `src/app/uslugi/service-accordion.tsx`

**Компонент:** `WynajemTable` (строки 359-882)

**Мобильная версия таблицы:**
- **Строки 777-878:** Мобильная версия таблицы (блок с классом `md:hidden`)
- **Строки 836-871:** Ячейки с ценами (`TableCell` для `plan1`, `plan2`, `plan3`)

**Структура:**
```tsx
<div className="md:hidden py-3">
  <div className="overflow-x-auto scroll-smooth">
    <Table className="border-separate" style={{ tableLayout: 'fixed' }}>
      <colgroup>
        <col style={{ width: '48%', minWidth: '120px' }} />  // Описание
        <col style={{ width: '17.33%', minWidth: '45px' }} /> // Цена 1
        <col style={{ width: '17.33%', minWidth: '45px' }} /> // Цена 2
        <col style={{ width: '17.33%', minWidth: '45px' }} /> // Цена 3
      </colgroup>
      <TableBody>
        <TableRow>
          <TableCell>...</TableCell> // Описание
          <TableCell>{renderValueWithSuffix(row.plan1, ...)}</TableCell> // Цена 1
          <TableCell>{renderValueWithSuffix(row.plan2, ...)}</TableCell> // Цена 2
          <TableCell>{renderValueWithSuffix(row.plan3, ...)}</TableCell> // Цена 3
        </TableRow>
      </TableBody>
    </Table>
  </div>
</div>
```

---

## 2. CSS-правила и Media Queries

### Применяемые стили к ячейкам с ценами:

**Строки 836-871:** `TableCell` для цен (`plan1`, `plan2`, `plan3`)

```tsx
<TableCell 
  className="pl-2 pr-1 py-2.5 align-middle text-center leading-[1.4] border-l-2 border-[#8b7a5a]" 
  style={{ 
    width: '17.33%',        // ⚠️ Фиксированная ширина
    minWidth: '45px',        // ⚠️ Минимальная ширина всего 45px
    maxWidth: '17.33%',     // ⚠️ Максимальная ширина ограничена
    boxSizing: 'border-box', 
    borderBottom: isLastRow ? 'none' : '1.5px solid rgba(139, 122, 90, 0.75)'
  }}
>
  {renderValueWithSuffix(row.plan1, valueFontSize, ...)}
</TableCell>
```

### Проблемные CSS-свойства:

1. **`tableLayout: 'fixed'`** (строка 779)
   - Принудительно фиксирует ширину колонок
   - Не позволяет контенту расширять ячейки

2. **`width: '17.33%'`** и **`maxWidth: '17.33%'`** (строки 839, 841, 851, 853, 863, 865)
   - Ограничивает ширину ячеек с ценами до 17.33% от ширины таблицы
   - На узких экранах это может быть слишком мало

3. **`minWidth: '45px'`** (строки 840, 852, 864)
   - Минимальная ширина всего 45px — очень мало для отображения цен
   - Цены могут содержать длинные значения (например, "2 000 + 300" с подписями "mono" и "kolor")

4. **`overflow-x-auto`** (строка 778)
   - Включает горизонтальную прокрутку, но не решает проблему скрытия контента

### Media Queries:

- **`md:hidden`** (строка 777) — показывает мобильную версию только на экранах < 768px
- **`hidden md:flex`** (строка 558) — скрывает десктопную версию на мобильных
- **`md:hidden`** (строка 582) — показывает мобильную версию цен с подписями mono/kolor

---

## 3. JavaScript-логика и функции

### Функция рендеринга цен: `renderValueWithSuffix` (строки 544-720)

**Проблемные места:**

1. **Строки 582-604:** Мобильная версия для значений типа "1 000 + 0" с подписями mono/kolor
   ```tsx
   <div className="md:hidden flex flex-col items-center">
     <span>{firstPart}</span>      // "1 000"
     <span>mono</span>              // "mono"
     <div>+ {secondPart}</div>     // "+ 0"
     <span>kolor</span>             // "kolor"
   </div>
   ```
   - Создаёт 4 строки контента в одной ячейке
   - При ширине ячейки 45px контент может не помещаться

2. **Строки 672-685:** Для значений типа "500 str./mies."
   ```tsx
   <div className="flex flex-col items-center">
     <span>{number}</span>          // "500"
     <span>str./mies.</span>        // "str./mies."
   </div>
   ```
   - Создаёт 2 строки контента

3. **Строки 704-716:** Для значений типа "0,05 zł"
   ```tsx
   <span className="inline-flex items-start">
     <span>{number}</span>          // "0,05"
     <span>zł</span>                 // "zł"
   </span>
   ```
   - Использует `inline-flex`, что может вызывать проблемы при ограниченной ширине

### Логика аккордеонов:

- **Строки 1830-1839:** Используется `Accordion` с типом `multiple` для подкатегорий wynajem
- **Строки 1076-1078:** `handleWynajemSubcategoryChange` управляет открытием/закрытием подкатегорий
- **Строки 1704-1712:** Условие рендеринга `WynajemTable` — таблица показывается только если `subcategory.items.length === 0`

---

## 4. Ошибки в консоли браузера

### Найденные предупреждения:

1. **React DevTools warning** (не критично)
   - Предложение установить React DevTools

2. **Function components cannot be given refs** (не критично)
   - Предупреждение о передаче refs в функциональные компоненты
   - Не влияет на отображение цен

3. **Нет ошибок, связанных с загрузкой данных или отображением цен**

---

## 5. Точное место проблемы в коде

### Основная проблема: **Слишком узкие колонки с фиксированной шириной**

**Файл:** `src/app/uslugi/service-accordion.tsx`

**Проблемные строки:**

1. **Строка 779:** `tableLayout: 'fixed'`
   - Принудительно фиксирует ширину колонок, не позволяя контенту расширять ячейки

2. **Строки 781-784:** `colgroup` с фиксированными ширинами
   ```tsx
   <col style={{ width: '17.33%', minWidth: '45px' }} />
   ```
   - Ширина 17.33% на узких экранах может быть недостаточной
   - `minWidth: '45px'` слишком мал для отображения цен с подписями

3. **Строки 839-844, 850-856, 862-868:** Inline стили для `TableCell` с ценами
   ```tsx
   style={{ 
     width: '17.33%',
     minWidth: '45px',
     maxWidth: '17.33%',
     boxSizing: 'border-box'
   }}
   ```
   - Тройное ограничение ширины (`width`, `minWidth`, `maxWidth`) может обрезать контент

4. **Строки 582-604:** Мобильная версия рендеринга цен с подписями mono/kolor
   - Создаёт 4 строки контента в одной ячейке
   - При ширине 45px контент может не помещаться и обрезаться

---

## 6. Краткое заключение

### Причина проблемы:

**Цены не отображаются в мобильной версии из-за слишком узких колонок с фиксированной шириной.**

1. **Таблица использует `tableLayout: 'fixed'`**, что принудительно фиксирует ширину колонок
2. **Колонки с ценами имеют ширину всего 17.33%** от ширины таблицы
3. **Минимальная ширина колонок — 45px**, что недостаточно для отображения:
   - Цен с подписями "mono" и "kolor" (4 строки контента)
   - Цен с суффиксами "str./mies." (2 строки контента)
   - Длинных числовых значений (например, "2 000 + 300")
4. **Тройное ограничение ширины** (`width`, `minWidth`, `maxWidth`) не позволяет ячейкам расширяться для размещения контента
5. **Контент обрезается или скрывается** из-за недостаточной ширины ячеек

### Дополнительные находки:

**Строка 724:** `overflow-hidden` на контейнере таблицы
```tsx
<div className="... overflow-hidden">
```
- Может скрывать контент, выходящий за границы контейнера

**Строка 795:** `overflow: 'hidden'` в стиле заголовка таблицы
```tsx
<TableHead style={{ overflow: 'hidden' }}>
```
- Применяется к заголовку "Czynsz wynajmu [zł/mies.]", но может влиять на дочерние элементы

### Рекомендации по исправлению:

1. **Увеличить `minWidth` для колонок с ценами** (например, до 80-100px)
2. **Убрать или ослабить ограничение `maxWidth: '17.33%'`**
3. **Рассмотреть использование `tableLayout: 'auto'` вместо `'fixed'`**
4. **Увеличить ширину колонок с ценами** (например, до 20-25% каждая)
5. **Убрать `overflow-hidden` с контейнера таблицы** (строка 724) или заменить на `overflow-visible`
6. **Проверить влияние `overflow: 'hidden'` на заголовке таблицы** (строка 795)

---

**Статус:** ✅ Проблема идентифицирована — узкие колонки с фиксированной шириной обрезают контент цен в мобильной версии.

